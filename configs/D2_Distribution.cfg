enable
configure terminal
hostname D2
ip routing
!
vlan 10,20,30,40
vlan 902
 name Uplink-to-C1
!
interface Loopback0
 ip address 3.3.3.3 255.255.255.255
 ip ospf 1 area 0
!
ip dhcp excluded-address 10.1.30.1 10.1.30.10
ip dhcp excluded-address 10.1.40.1 10.1.40.10
!
ip dhcp pool VLAN30_POOL
 network 10.1.30.0 255.255.255.0
 default-router 10.1.30.1
 dns-server 8.8.8.8
!
ip dhcp pool VLAN40_POOL
 network 10.1.40.0 255.255.255.0
 default-router 10.1.40.1
 dns-server 8.8.8.8
!
spanning-tree mode mst
spanning-tree extend system-id
spanning-tree mst configuration
 name LAB-COMPLEX
 revision 1
 instance 1 vlan 10, 20
 instance 2 vlan 30, 40
exit
spanning-tree mst 1 priority 28672
spanning-tree mst 2 priority 24576
!
interface GigabitEthernet0/0
 description Uplink_to_C1
 switchport trunk allowed vlan 902
 switchport trunk encapsulation dot1q
 switchport mode trunk
 no shutdown
!
interface range GigabitEthernet0/1-3
 description Downlink_to_Access
 switchport trunk encapsulation dot1q
 switchport mode trunk
 no shutdown
!
interface Vlan10
 ip address 10.1.10.3 255.255.255.0
 no autostate
 standby version 2
 standby 10 ip 10.1.10.1
 no shutdown
!
interface Vlan20
 ip address 10.1.20.3 255.255.255.0
 no autostate
 standby version 2
 standby 20 ip 10.1.20.1
 no shutdown
!
interface Vlan30
 ip address 10.1.30.3 255.255.255.0
 no autostate
 standby version 2
 standby 30 ip 10.1.30.1
 standby 30 priority 150
 standby 30 preempt
 no shutdown
!
interface Vlan40
 ip address 10.1.40.3 255.255.255.0
 no autostate
 standby version 2
 standby 40 ip 10.1.40.1
 standby 40 priority 150
 standby 40 preempt
 no shutdown
!
interface Vlan902
 description L3_Link_C1
 ip address 172.16.2.2 255.255.255.252
 no autostate
 ip ospf 1 area 0
 no shutdown
!
router ospf 1
 router-id 3.3.3.3
 passive-interface default
 no passive-interface Vlan902
 no passive-interface Loopback0
 network 10.1.0.0 0.0.255.255 area 0
!
end
write